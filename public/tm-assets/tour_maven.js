(()=>{var At=class{constructor(t,e,n){this.eventTarget=t,this.eventName=e,this.eventOptions=n,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(t){this.unorderedBindings.add(t)}bindingDisconnected(t){this.unorderedBindings.delete(t)}handleEvent(t){let e=yi(t);for(let n of this.bindings){if(e.immediatePropagationStopped)break;n.handleEvent(e)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort((t,e)=>{let n=t.index,r=e.index;return n<r?-1:n>r?1:0})}};function yi(i){if("immediatePropagationStopped"in i)return i;{let{stopImmediatePropagation:t}=i;return Object.assign(i,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,t.call(this)}})}}var Tt=class{constructor(t){this.application=t,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach(t=>t.connect()))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach(t=>t.disconnect()))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce((t,e)=>t.concat(Array.from(e.values())),[])}bindingConnected(t){this.fetchEventListenerForBinding(t).bindingConnected(t)}bindingDisconnected(t,e=!1){this.fetchEventListenerForBinding(t).bindingDisconnected(t),e&&this.clearEventListenersForBinding(t)}handleError(t,e,n={}){this.application.handleError(t,`Error ${e}`,n)}clearEventListenersForBinding(t){let e=this.fetchEventListenerForBinding(t);e.hasBindings()||(e.disconnect(),this.removeMappedEventListenerFor(t))}removeMappedEventListenerFor(t){let{eventTarget:e,eventName:n,eventOptions:r}=t,s=this.fetchEventListenerMapForEventTarget(e),o=this.cacheKey(n,r);s.delete(o),s.size==0&&this.eventListenerMaps.delete(e)}fetchEventListenerForBinding(t){let{eventTarget:e,eventName:n,eventOptions:r}=t;return this.fetchEventListener(e,n,r)}fetchEventListener(t,e,n){let r=this.fetchEventListenerMapForEventTarget(t),s=this.cacheKey(e,n),o=r.get(s);return o||(o=this.createEventListener(t,e,n),r.set(s,o)),o}createEventListener(t,e,n){let r=new At(t,e,n);return this.started&&r.connect(),r}fetchEventListenerMapForEventTarget(t){let e=this.eventListenerMaps.get(t);return e||(e=new Map,this.eventListenerMaps.set(t,e)),e}cacheKey(t,e){let n=[t];return Object.keys(e).sort().forEach(r=>{n.push(`${e[r]?"":"!"}${r}`)}),n.join(":")}},bi={stop({event:i,value:t}){return t&&i.stopPropagation(),!0},prevent({event:i,value:t}){return t&&i.preventDefault(),!0},self({event:i,value:t,element:e}){return t?e===i.target:!0}},vi=/^(?:(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function wi(i){let e=i.trim().match(vi)||[],n=e[1],r=e[2];return r&&!["keydown","keyup","keypress"].includes(n)&&(n+=`.${r}`,r=""),{eventTarget:xi(e[3]),eventName:n,eventOptions:e[6]?Ei(e[6]):{},identifier:e[4],methodName:e[5],keyFilter:r}}function xi(i){if(i=="window")return window;if(i=="document")return document}function Ei(i){return i.split(":").reduce((t,e)=>Object.assign(t,{[e.replace(/^!/,"")]:!/^!/.test(e)}),{})}function ki(i){if(i==window)return"window";if(i==document)return"document"}function Jt(i){return i.replace(/(?:[_-])([a-z0-9])/g,(t,e)=>e.toUpperCase())}function Ot(i){return Jt(i.replace(/--/g,"-").replace(/__/g,"_"))}function Y(i){return i.charAt(0).toUpperCase()+i.slice(1)}function ye(i){return i.replace(/([A-Z])/g,(t,e)=>`-${e.toLowerCase()}`)}function Ci(i){return i.match(/[^\s]+/g)||[]}var St=class{constructor(t,e,n,r){this.element=t,this.index=e,this.eventTarget=n.eventTarget||t,this.eventName=n.eventName||Ai(t)||lt("missing event name"),this.eventOptions=n.eventOptions||{},this.identifier=n.identifier||lt("missing identifier"),this.methodName=n.methodName||lt("missing method name"),this.keyFilter=n.keyFilter||"",this.schema=r}static forToken(t,e){return new this(t.element,t.index,wi(t.content),e)}toString(){let t=this.keyFilter?`.${this.keyFilter}`:"",e=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${t}${e}->${this.identifier}#${this.methodName}`}isFilterTarget(t){if(!this.keyFilter)return!1;let e=this.keyFilter.split("+"),n=["meta","ctrl","alt","shift"],[r,s,o,a]=n.map(l=>e.includes(l));if(t.metaKey!==r||t.ctrlKey!==s||t.altKey!==o||t.shiftKey!==a)return!0;let c=e.filter(l=>!n.includes(l))[0];return c?(Object.prototype.hasOwnProperty.call(this.keyMappings,c)||lt(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[c].toLowerCase()!==t.key.toLowerCase()):!1}get params(){let t={},e=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(let{name:n,value:r}of Array.from(this.element.attributes)){let s=n.match(e),o=s&&s[1];o&&(t[Jt(o)]=Ti(r))}return t}get eventTargetName(){return ki(this.eventTarget)}get keyMappings(){return this.schema.keyMappings}},fe={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:i=>i.getAttribute("type")=="submit"?"click":"input",select:()=>"change",textarea:()=>"input"};function Ai(i){let t=i.tagName.toLowerCase();if(t in fe)return fe[t](i)}function lt(i){throw new Error(i)}function Ti(i){try{return JSON.parse(i)}catch{return i}}var Bt=class{constructor(t,e){this.context=t,this.action=e}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(t){this.willBeInvokedByEvent(t)&&this.applyEventModifiers(t)&&this.invokeWithEvent(t)}get eventName(){return this.action.eventName}get method(){let t=this.controller[this.methodName];if(typeof t=="function")return t;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(t){let{element:e}=this.action,{actionDescriptorFilters:n}=this.context.application,r=!0;for(let[s,o]of Object.entries(this.eventOptions))if(s in n){let a=n[s];r=r&&a({name:s,value:o,event:t,element:e})}else continue;return r}invokeWithEvent(t){let{target:e,currentTarget:n}=t;try{let{params:r}=this.action,s=Object.assign(t,{params:r});this.method.call(this.controller,s),this.context.logDebugActivity(this.methodName,{event:t,target:e,currentTarget:n,action:this.methodName})}catch(r){let{identifier:s,controller:o,element:a,index:c}=this,l={identifier:s,controller:o,element:a,index:c,event:t};this.context.handleError(r,`invoking action "${this.action}"`,l)}}willBeInvokedByEvent(t){let e=t.target;return t instanceof KeyboardEvent&&this.action.isFilterTarget(t)?!1:this.element===e?!0:e instanceof Element&&this.element.contains(e)?this.scope.containsElement(e):this.scope.containsElement(this.action.element)}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}},ut=class{constructor(t,e){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=t,this.started=!1,this.delegate=e,this.elements=new Set,this.mutationObserver=new MutationObserver(n=>this.processMutations(n))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(t){this.started&&(this.mutationObserver.disconnect(),this.started=!1),t(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){let t=new Set(this.matchElementsInTree());for(let e of Array.from(this.elements))t.has(e)||this.removeElement(e);for(let e of Array.from(t))this.addElement(e)}}processMutations(t){if(this.started)for(let e of t)this.processMutation(e)}processMutation(t){t.type=="attributes"?this.processAttributeChange(t.target,t.attributeName):t.type=="childList"&&(this.processRemovedNodes(t.removedNodes),this.processAddedNodes(t.addedNodes))}processAttributeChange(t,e){let n=t;this.elements.has(n)?this.delegate.elementAttributeChanged&&this.matchElement(n)?this.delegate.elementAttributeChanged(n,e):this.removeElement(n):this.matchElement(n)&&this.addElement(n)}processRemovedNodes(t){for(let e of Array.from(t)){let n=this.elementFromNode(e);n&&this.processTree(n,this.removeElement)}}processAddedNodes(t){for(let e of Array.from(t)){let n=this.elementFromNode(e);n&&this.elementIsActive(n)&&this.processTree(n,this.addElement)}}matchElement(t){return this.delegate.matchElement(t)}matchElementsInTree(t=this.element){return this.delegate.matchElementsInTree(t)}processTree(t,e){for(let n of this.matchElementsInTree(t))e.call(this,n)}elementFromNode(t){if(t.nodeType==Node.ELEMENT_NODE)return t}elementIsActive(t){return t.isConnected!=this.element.isConnected?!1:this.element.contains(t)}addElement(t){this.elements.has(t)||this.elementIsActive(t)&&(this.elements.add(t),this.delegate.elementMatched&&this.delegate.elementMatched(t))}removeElement(t){this.elements.has(t)&&(this.elements.delete(t),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(t))}},Lt=class{constructor(t,e,n){this.attributeName=e,this.delegate=n,this.elementObserver=new ut(t,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(t){this.elementObserver.pause(t)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(t){return t.hasAttribute(this.attributeName)}matchElementsInTree(t){let e=this.matchElement(t)?[t]:[],n=Array.from(t.querySelectorAll(this.selector));return e.concat(n)}elementMatched(t){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(t,this.attributeName)}elementUnmatched(t){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(t,this.attributeName)}elementAttributeChanged(t,e){this.delegate.elementAttributeValueChanged&&this.attributeName==e&&this.delegate.elementAttributeValueChanged(t,e)}};function Oi(i,t,e){be(i,t).add(e)}function Si(i,t,e){be(i,t).delete(e),Bi(i,t)}function be(i,t){let e=i.get(t);return e||(e=new Set,i.set(t,e)),e}function Bi(i,t){let e=i.get(t);e!=null&&e.size==0&&i.delete(t)}var M=class{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce((e,n)=>e.concat(Array.from(n)),[])}get size(){return Array.from(this.valuesByKey.values()).reduce((e,n)=>e+n.size,0)}add(t,e){Oi(this.valuesByKey,t,e)}delete(t,e){Si(this.valuesByKey,t,e)}has(t,e){let n=this.valuesByKey.get(t);return n!=null&&n.has(e)}hasKey(t){return this.valuesByKey.has(t)}hasValue(t){return Array.from(this.valuesByKey.values()).some(n=>n.has(t))}getValuesForKey(t){let e=this.valuesByKey.get(t);return e?Array.from(e):[]}getKeysForValue(t){return Array.from(this.valuesByKey).filter(([e,n])=>n.has(t)).map(([e,n])=>e)}};var Mt=class{constructor(t,e,n,r={}){this.selector=e,this.details=r,this.elementObserver=new ut(t,this),this.delegate=n,this.matchesByElement=new M}get started(){return this.elementObserver.started}start(){this.elementObserver.start()}pause(t){this.elementObserver.pause(t)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(t){let e=t.matches(this.selector);return this.delegate.selectorMatchElement?e&&this.delegate.selectorMatchElement(t,this.details):e}matchElementsInTree(t){let e=this.matchElement(t)?[t]:[],n=Array.from(t.querySelectorAll(this.selector)).filter(r=>this.matchElement(r));return e.concat(n)}elementMatched(t){this.selectorMatched(t)}elementUnmatched(t){this.selectorUnmatched(t)}elementAttributeChanged(t,e){let n=this.matchElement(t),r=this.matchesByElement.has(this.selector,t);!n&&r&&this.selectorUnmatched(t)}selectorMatched(t){this.delegate.selectorMatched&&(this.delegate.selectorMatched(t,this.selector,this.details),this.matchesByElement.add(this.selector,t))}selectorUnmatched(t){this.delegate.selectorUnmatched(t,this.selector,this.details),this.matchesByElement.delete(this.selector,t)}},Ft=class{constructor(t,e){this.element=t,this.delegate=e,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver(n=>this.processMutations(n))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(let t of this.knownAttributeNames)this.refreshAttribute(t,null)}processMutations(t){if(this.started)for(let e of t)this.processMutation(e)}processMutation(t){let e=t.attributeName;e&&this.refreshAttribute(e,t.oldValue)}refreshAttribute(t,e){let n=this.delegate.getStringMapKeyForAttribute(t);if(n!=null){this.stringMap.has(t)||this.stringMapKeyAdded(n,t);let r=this.element.getAttribute(t);if(this.stringMap.get(t)!=r&&this.stringMapValueChanged(r,n,e),r==null){let s=this.stringMap.get(t);this.stringMap.delete(t),s&&this.stringMapKeyRemoved(n,t,s)}else this.stringMap.set(t,r)}}stringMapKeyAdded(t,e){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(t,e)}stringMapValueChanged(t,e,n){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(t,e,n)}stringMapKeyRemoved(t,e,n){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(t,e,n)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map(t=>t.name)}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}},dt=class{constructor(t,e,n){this.attributeObserver=new Lt(t,e,this),this.delegate=n,this.tokensByElement=new M}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(t){this.attributeObserver.pause(t)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(t){this.tokensMatched(this.readTokensForElement(t))}elementAttributeValueChanged(t){let[e,n]=this.refreshTokensForElement(t);this.tokensUnmatched(e),this.tokensMatched(n)}elementUnmatchedAttribute(t){this.tokensUnmatched(this.tokensByElement.getValuesForKey(t))}tokensMatched(t){t.forEach(e=>this.tokenMatched(e))}tokensUnmatched(t){t.forEach(e=>this.tokenUnmatched(e))}tokenMatched(t){this.delegate.tokenMatched(t),this.tokensByElement.add(t.element,t)}tokenUnmatched(t){this.delegate.tokenUnmatched(t),this.tokensByElement.delete(t.element,t)}refreshTokensForElement(t){let e=this.tokensByElement.getValuesForKey(t),n=this.readTokensForElement(t),r=Mi(e,n).findIndex(([s,o])=>!Fi(s,o));return r==-1?[[],[]]:[e.slice(r),n.slice(r)]}readTokensForElement(t){let e=this.attributeName,n=t.getAttribute(e)||"";return Li(n,t,e)}};function Li(i,t,e){return i.trim().split(/\s+/).filter(n=>n.length).map((n,r)=>({element:t,attributeName:e,content:n,index:r}))}function Mi(i,t){let e=Math.max(i.length,t.length);return Array.from({length:e},(n,r)=>[i[r],t[r]])}function Fi(i,t){return i&&t&&i.index==t.index&&i.content==t.content}var ht=class{constructor(t,e,n){this.tokenListObserver=new dt(t,e,this),this.delegate=n,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(t){let{element:e}=t,{value:n}=this.fetchParseResultForToken(t);n&&(this.fetchValuesByTokenForElement(e).set(t,n),this.delegate.elementMatchedValue(e,n))}tokenUnmatched(t){let{element:e}=t,{value:n}=this.fetchParseResultForToken(t);n&&(this.fetchValuesByTokenForElement(e).delete(t),this.delegate.elementUnmatchedValue(e,n))}fetchParseResultForToken(t){let e=this.parseResultsByToken.get(t);return e||(e=this.parseToken(t),this.parseResultsByToken.set(t,e)),e}fetchValuesByTokenForElement(t){let e=this.valuesByTokenByElement.get(t);return e||(e=new Map,this.valuesByTokenByElement.set(t,e)),e}parseToken(t){try{return{value:this.delegate.parseValueForToken(t)}}catch(e){return{error:e}}}},Pt=class{constructor(t,e){this.context=t,this.delegate=e,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new ht(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(t){let e=new Bt(this.context,t);this.bindingsByAction.set(t,e),this.delegate.bindingConnected(e)}disconnectAction(t){let e=this.bindingsByAction.get(t);e&&(this.bindingsByAction.delete(t),this.delegate.bindingDisconnected(e))}disconnectAllActions(){this.bindings.forEach(t=>this.delegate.bindingDisconnected(t,!0)),this.bindingsByAction.clear()}parseValueForToken(t){let e=St.forToken(t,this.schema);if(e.identifier==this.identifier)return e}elementMatchedValue(t,e){this.connectAction(e)}elementUnmatchedValue(t,e){this.disconnectAction(e)}},Dt=class{constructor(t,e){this.context=t,this.receiver=e,this.stringMapObserver=new Ft(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(t){if(t in this.valueDescriptorMap)return this.valueDescriptorMap[t].name}stringMapKeyAdded(t,e){let n=this.valueDescriptorMap[e];this.hasValue(t)||this.invokeChangedCallback(t,n.writer(this.receiver[t]),n.writer(n.defaultValue))}stringMapValueChanged(t,e,n){let r=this.valueDescriptorNameMap[e];t!==null&&(n===null&&(n=r.writer(r.defaultValue)),this.invokeChangedCallback(e,t,n))}stringMapKeyRemoved(t,e,n){let r=this.valueDescriptorNameMap[t];this.hasValue(t)?this.invokeChangedCallback(t,r.writer(this.receiver[t]),n):this.invokeChangedCallback(t,r.writer(r.defaultValue),n)}invokeChangedCallbacksForDefaultValues(){for(let{key:t,name:e,defaultValue:n,writer:r}of this.valueDescriptors)n!=null&&!this.controller.data.has(t)&&this.invokeChangedCallback(e,r(n),void 0)}invokeChangedCallback(t,e,n){let r=`${t}Changed`,s=this.receiver[r];if(typeof s=="function"){let o=this.valueDescriptorNameMap[t];try{let a=o.reader(e),c=n;n&&(c=o.reader(n)),s.call(this.receiver,a,c)}catch(a){throw a instanceof TypeError&&(a.message=`Stimulus Value "${this.context.identifier}.${o.name}" - ${a.message}`),a}}}get valueDescriptors(){let{valueDescriptorMap:t}=this;return Object.keys(t).map(e=>t[e])}get valueDescriptorNameMap(){let t={};return Object.keys(this.valueDescriptorMap).forEach(e=>{let n=this.valueDescriptorMap[e];t[n.name]=n}),t}hasValue(t){let e=this.valueDescriptorNameMap[t],n=`has${Y(e.name)}`;return this.receiver[n]}},Nt=class{constructor(t,e){this.context=t,this.delegate=e,this.targetsByName=new M}start(){this.tokenListObserver||(this.tokenListObserver=new dt(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:t,content:e}){this.scope.containsElement(t)&&this.connectTarget(t,e)}tokenUnmatched({element:t,content:e}){this.disconnectTarget(t,e)}connectTarget(t,e){var n;this.targetsByName.has(e,t)||(this.targetsByName.add(e,t),(n=this.tokenListObserver)===null||n===void 0||n.pause(()=>this.delegate.targetConnected(t,e)))}disconnectTarget(t,e){var n;this.targetsByName.has(e,t)&&(this.targetsByName.delete(e,t),(n=this.tokenListObserver)===null||n===void 0||n.pause(()=>this.delegate.targetDisconnected(t,e)))}disconnectAllTargets(){for(let t of this.targetsByName.keys)for(let e of this.targetsByName.getValuesForKey(t))this.disconnectTarget(e,t)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}};function Q(i,t){let e=ve(i);return Array.from(e.reduce((n,r)=>(Di(r,t).forEach(s=>n.add(s)),n),new Set))}function Pi(i,t){return ve(i).reduce((n,r)=>(n.push(...Ni(r,t)),n),[])}function ve(i){let t=[];for(;i;)t.push(i),i=Object.getPrototypeOf(i);return t.reverse()}function Di(i,t){let e=i[t];return Array.isArray(e)?e:[]}function Ni(i,t){let e=i[t];return e?Object.keys(e).map(n=>[n,e[n]]):[]}var Rt=class{constructor(t,e){this.context=t,this.delegate=e,this.outletsByName=new M,this.outletElementsByName=new M,this.selectorObserverMap=new Map}start(){this.selectorObserverMap.size===0&&(this.outletDefinitions.forEach(t=>{let e=this.selector(t),n={outletName:t};e&&this.selectorObserverMap.set(t,new Mt(document.body,e,this,n))}),this.selectorObserverMap.forEach(t=>t.start())),this.dependentContexts.forEach(t=>t.refresh())}stop(){this.selectorObserverMap.size>0&&(this.disconnectAllOutlets(),this.selectorObserverMap.forEach(t=>t.stop()),this.selectorObserverMap.clear())}refresh(){this.selectorObserverMap.forEach(t=>t.refresh())}selectorMatched(t,e,{outletName:n}){let r=this.getOutlet(t,n);r&&this.connectOutlet(r,t,n)}selectorUnmatched(t,e,{outletName:n}){let r=this.getOutletFromMap(t,n);r&&this.disconnectOutlet(r,t,n)}selectorMatchElement(t,{outletName:e}){return this.hasOutlet(t,e)&&t.matches(`[${this.context.application.schema.controllerAttribute}~=${e}]`)}connectOutlet(t,e,n){var r;this.outletElementsByName.has(n,e)||(this.outletsByName.add(n,t),this.outletElementsByName.add(n,e),(r=this.selectorObserverMap.get(n))===null||r===void 0||r.pause(()=>this.delegate.outletConnected(t,e,n)))}disconnectOutlet(t,e,n){var r;this.outletElementsByName.has(n,e)&&(this.outletsByName.delete(n,t),this.outletElementsByName.delete(n,e),(r=this.selectorObserverMap.get(n))===null||r===void 0||r.pause(()=>this.delegate.outletDisconnected(t,e,n)))}disconnectAllOutlets(){for(let t of this.outletElementsByName.keys)for(let e of this.outletElementsByName.getValuesForKey(t))for(let n of this.outletsByName.getValuesForKey(t))this.disconnectOutlet(n,e,t)}selector(t){return this.scope.outlets.getSelectorForOutletName(t)}get outletDependencies(){let t=new M;return this.router.modules.forEach(e=>{let n=e.definition.controllerConstructor;Q(n,"outlets").forEach(s=>t.add(s,e.identifier))}),t}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){let t=this.dependentControllerIdentifiers;return this.router.contexts.filter(e=>t.includes(e.identifier))}hasOutlet(t,e){return!!this.getOutlet(t,e)||!!this.getOutletFromMap(t,e)}getOutlet(t,e){return this.application.getControllerForElementAndIdentifier(t,e)}getOutletFromMap(t,e){return this.outletsByName.getValuesForKey(e).find(n=>n.element===t)}get scope(){return this.context.scope}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}},$t=class{constructor(t,e){this.logDebugActivity=(n,r={})=>{let{identifier:s,controller:o,element:a}=this;r=Object.assign({identifier:s,controller:o,element:a},r),this.application.logDebugActivity(this.identifier,n,r)},this.module=t,this.scope=e,this.controller=new t.controllerConstructor(this),this.bindingObserver=new Pt(this,this.dispatcher),this.valueObserver=new Dt(this,this.controller),this.targetObserver=new Nt(this,this),this.outletObserver=new Rt(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(n){this.handleError(n,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(t){this.handleError(t,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(t){this.handleError(t,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(t,e,n={}){let{identifier:r,controller:s,element:o}=this;n=Object.assign({identifier:r,controller:s,element:o},n),this.application.handleError(t,`Error ${e}`,n)}targetConnected(t,e){this.invokeControllerMethod(`${e}TargetConnected`,t)}targetDisconnected(t,e){this.invokeControllerMethod(`${e}TargetDisconnected`,t)}outletConnected(t,e,n){this.invokeControllerMethod(`${Ot(n)}OutletConnected`,t,e)}outletDisconnected(t,e,n){this.invokeControllerMethod(`${Ot(n)}OutletDisconnected`,t,e)}invokeControllerMethod(t,...e){let n=this.controller;typeof n[t]=="function"&&n[t](...e)}};function Ri(i){return $i(i,Vi(i))}function $i(i,t){let e=Gi(i),n=_i(i.prototype,t);return Object.defineProperties(e.prototype,n),e}function Vi(i){return Q(i,"blessings").reduce((e,n)=>{let r=n(i);for(let s in r){let o=e[s]||{};e[s]=Object.assign(o,r[s])}return e},{})}function _i(i,t){return Hi(t).reduce((e,n)=>{let r=ji(i,t,n);return r&&Object.assign(e,{[n]:r}),e},{})}function ji(i,t,e){let n=Object.getOwnPropertyDescriptor(i,e);if(!(n&&"value"in n)){let s=Object.getOwnPropertyDescriptor(t,e).value;return n&&(s.get=n.get||s.get,s.set=n.set||s.set),s}}var Hi=(()=>typeof Object.getOwnPropertySymbols=="function"?i=>[...Object.getOwnPropertyNames(i),...Object.getOwnPropertySymbols(i)]:Object.getOwnPropertyNames)(),Gi=(()=>{function i(e){function n(){return Reflect.construct(e,arguments,new.target)}return n.prototype=Object.create(e.prototype,{constructor:{value:n}}),Reflect.setPrototypeOf(n,e),n}function t(){let n=i(function(){this.a.call(this)});return n.prototype.a=function(){},new n}try{return t(),i}catch{return n=>class extends n{}}})();function Ki(i){return{identifier:i.identifier,controllerConstructor:Ri(i.controllerConstructor)}}var Vt=class{constructor(t,e){this.application=t,this.definition=Ki(e),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(t){let e=this.fetchContextForScope(t);this.connectedContexts.add(e),e.connect()}disconnectContextForScope(t){let e=this.contextsByScope.get(t);e&&(this.connectedContexts.delete(e),e.disconnect())}fetchContextForScope(t){let e=this.contextsByScope.get(t);return e||(e=new $t(this,t),this.contextsByScope.set(t,e)),e}},_t=class{constructor(t){this.scope=t}has(t){return this.data.has(this.getDataKey(t))}get(t){return this.getAll(t)[0]}getAll(t){let e=this.data.get(this.getDataKey(t))||"";return Ci(e)}getAttributeName(t){return this.data.getAttributeNameForKey(this.getDataKey(t))}getDataKey(t){return`${t}-class`}get data(){return this.scope.data}},jt=class{constructor(t){this.scope=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(t){let e=this.getAttributeNameForKey(t);return this.element.getAttribute(e)}set(t,e){let n=this.getAttributeNameForKey(t);return this.element.setAttribute(n,e),this.get(t)}has(t){let e=this.getAttributeNameForKey(t);return this.element.hasAttribute(e)}delete(t){if(this.has(t)){let e=this.getAttributeNameForKey(t);return this.element.removeAttribute(e),!0}else return!1}getAttributeNameForKey(t){return`data-${this.identifier}-${ye(t)}`}},Ht=class{constructor(t){this.warnedKeysByObject=new WeakMap,this.logger=t}warn(t,e,n){let r=this.warnedKeysByObject.get(t);r||(r=new Set,this.warnedKeysByObject.set(t,r)),r.has(e)||(r.add(e),this.logger.warn(n,t))}};function Gt(i,t){return`[${i}~="${t}"]`}var Kt=class{constructor(t){this.scope=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(t){return this.find(t)!=null}find(...t){return t.reduce((e,n)=>e||this.findTarget(n)||this.findLegacyTarget(n),void 0)}findAll(...t){return t.reduce((e,n)=>[...e,...this.findAllTargets(n),...this.findAllLegacyTargets(n)],[])}findTarget(t){let e=this.getSelectorForTargetName(t);return this.scope.findElement(e)}findAllTargets(t){let e=this.getSelectorForTargetName(t);return this.scope.findAllElements(e)}getSelectorForTargetName(t){let e=this.schema.targetAttributeForScope(this.identifier);return Gt(e,t)}findLegacyTarget(t){let e=this.getLegacySelectorForTargetName(t);return this.deprecate(this.scope.findElement(e),t)}findAllLegacyTargets(t){let e=this.getLegacySelectorForTargetName(t);return this.scope.findAllElements(e).map(n=>this.deprecate(n,t))}getLegacySelectorForTargetName(t){let e=`${this.identifier}.${t}`;return Gt(this.schema.targetAttribute,e)}deprecate(t,e){if(t){let{identifier:n}=this,r=this.schema.targetAttribute,s=this.schema.targetAttributeForScope(n);this.guide.warn(t,`target:${e}`,`Please replace ${r}="${n}.${e}" with ${s}="${e}". The ${r} attribute is deprecated and will be removed in a future version of Stimulus.`)}return t}get guide(){return this.scope.guide}},zt=class{constructor(t,e){this.scope=t,this.controllerElement=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(t){return this.find(t)!=null}find(...t){return t.reduce((e,n)=>e||this.findOutlet(n),void 0)}findAll(...t){return t.reduce((e,n)=>[...e,...this.findAllOutlets(n)],[])}getSelectorForOutletName(t){let e=this.schema.outletAttributeForScope(this.identifier,t);return this.controllerElement.getAttribute(e)}findOutlet(t){let e=this.getSelectorForOutletName(t);if(e)return this.findElement(e,t)}findAllOutlets(t){let e=this.getSelectorForOutletName(t);return e?this.findAllElements(e,t):[]}findElement(t,e){return this.scope.queryElements(t).filter(r=>this.matchesElement(r,t,e))[0]}findAllElements(t,e){return this.scope.queryElements(t).filter(r=>this.matchesElement(r,t,e))}matchesElement(t,e,n){let r=t.getAttribute(this.scope.schema.controllerAttribute)||"";return t.matches(e)&&r.split(" ").includes(n)}},Wt=class i{constructor(t,e,n,r){this.targets=new Kt(this),this.classes=new _t(this),this.data=new jt(this),this.containsElement=s=>s.closest(this.controllerSelector)===this.element,this.schema=t,this.element=e,this.identifier=n,this.guide=new Ht(r),this.outlets=new zt(this.documentScope,e)}findElement(t){return this.element.matches(t)?this.element:this.queryElements(t).find(this.containsElement)}findAllElements(t){return[...this.element.matches(t)?[this.element]:[],...this.queryElements(t).filter(this.containsElement)]}queryElements(t){return Array.from(this.element.querySelectorAll(t))}get controllerSelector(){return Gt(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new i(this.schema,document.documentElement,this.identifier,this.guide.logger)}},qt=class{constructor(t,e,n){this.element=t,this.schema=e,this.delegate=n,this.valueListObserver=new ht(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(t){let{element:e,content:n}=t,r=this.fetchScopesByIdentifierForElement(e),s=r.get(n);return s||(s=this.delegate.createScopeForElementAndIdentifier(e,n),r.set(n,s)),s}elementMatchedValue(t,e){let n=(this.scopeReferenceCounts.get(e)||0)+1;this.scopeReferenceCounts.set(e,n),n==1&&this.delegate.scopeConnected(e)}elementUnmatchedValue(t,e){let n=this.scopeReferenceCounts.get(e);n&&(this.scopeReferenceCounts.set(e,n-1),n==1&&this.delegate.scopeDisconnected(e))}fetchScopesByIdentifierForElement(t){let e=this.scopesByIdentifierByElement.get(t);return e||(e=new Map,this.scopesByIdentifierByElement.set(t,e)),e}},Ut=class{constructor(t){this.application=t,this.scopeObserver=new qt(this.element,this.schema,this),this.scopesByIdentifier=new M,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce((t,e)=>t.concat(e.contexts),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(t){this.unloadIdentifier(t.identifier);let e=new Vt(this.application,t);this.connectModule(e);let n=t.controllerConstructor.afterLoad;n&&n(t.identifier,this.application)}unloadIdentifier(t){let e=this.modulesByIdentifier.get(t);e&&this.disconnectModule(e)}getContextForElementAndIdentifier(t,e){let n=this.modulesByIdentifier.get(e);if(n)return n.contexts.find(r=>r.element==t)}handleError(t,e,n){this.application.handleError(t,e,n)}createScopeForElementAndIdentifier(t,e){return new Wt(this.schema,t,e,this.logger)}scopeConnected(t){this.scopesByIdentifier.add(t.identifier,t);let e=this.modulesByIdentifier.get(t.identifier);e&&e.connectContextForScope(t)}scopeDisconnected(t){this.scopesByIdentifier.delete(t.identifier,t);let e=this.modulesByIdentifier.get(t.identifier);e&&e.disconnectContextForScope(t)}connectModule(t){this.modulesByIdentifier.set(t.identifier,t),this.scopesByIdentifier.getValuesForKey(t.identifier).forEach(n=>t.connectContextForScope(n))}disconnectModule(t){this.modulesByIdentifier.delete(t.identifier),this.scopesByIdentifier.getValuesForKey(t.identifier).forEach(n=>t.disconnectContextForScope(n))}},zi={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:i=>`data-${i}-target`,outletAttributeForScope:(i,t)=>`data-${i}-${t}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End"},pe("abcdefghijklmnopqrstuvwxyz".split("").map(i=>[i,i]))),pe("0123456789".split("").map(i=>[i,i])))};function pe(i){return i.reduce((t,[e,n])=>Object.assign(Object.assign({},t),{[e]:n}),{})}var ft=class{constructor(t=document.documentElement,e=zi){this.logger=console,this.debug=!1,this.logDebugActivity=(n,r,s={})=>{this.debug&&this.logFormattedMessage(n,r,s)},this.element=t,this.schema=e,this.dispatcher=new Tt(this),this.router=new Ut(this),this.actionDescriptorFilters=Object.assign({},bi)}static start(t,e){let n=new this(t,e);return n.start(),n}async start(){await Wi(),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(t,e){this.load({identifier:t,controllerConstructor:e})}registerActionOption(t,e){this.actionDescriptorFilters[t]=e}load(t,...e){(Array.isArray(t)?t:[t,...e]).forEach(r=>{r.controllerConstructor.shouldLoad&&this.router.loadDefinition(r)})}unload(t,...e){(Array.isArray(t)?t:[t,...e]).forEach(r=>this.router.unloadIdentifier(r))}get controllers(){return this.router.contexts.map(t=>t.controller)}getControllerForElementAndIdentifier(t,e){let n=this.router.getContextForElementAndIdentifier(t,e);return n?n.controller:null}handleError(t,e,n){var r;this.logger.error(`%s

%o

%o`,e,t,n),(r=window.onerror)===null||r===void 0||r.call(window,e,"",0,0,t)}logFormattedMessage(t,e,n={}){n=Object.assign({application:this},n),this.logger.groupCollapsed(`${t} #${e}`),this.logger.log("details:",Object.assign({},n)),this.logger.groupEnd()}};function Wi(){return new Promise(i=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",()=>i()):i()})}function qi(i){return Q(i,"classes").reduce((e,n)=>Object.assign(e,Ui(n)),{})}function Ui(i){return{[`${i}Class`]:{get(){let{classes:t}=this;if(t.has(i))return t.get(i);{let e=t.getAttributeName(i);throw new Error(`Missing attribute "${e}"`)}}},[`${i}Classes`]:{get(){return this.classes.getAll(i)}},[`has${Y(i)}Class`]:{get(){return this.classes.has(i)}}}}function Ji(i){return Q(i,"outlets").reduce((e,n)=>Object.assign(e,Xi(n)),{})}function Xi(i){let t=Ot(i);return{[`${t}Outlet`]:{get(){let e=this.outlets.find(i);if(e){let n=this.application.getControllerForElementAndIdentifier(e,i);if(n)return n;throw new Error(`Missing "data-controller=${i}" attribute on outlet element for "${this.identifier}" controller`)}throw new Error(`Missing outlet element "${i}" for "${this.identifier}" controller`)}},[`${t}Outlets`]:{get(){let e=this.outlets.findAll(i);return e.length>0?e.map(n=>{let r=this.application.getControllerForElementAndIdentifier(n,i);if(r)return r;console.warn(`The provided outlet element is missing the outlet controller "${i}" for "${this.identifier}"`,n)}).filter(n=>n):[]}},[`${t}OutletElement`]:{get(){let e=this.outlets.find(i);if(e)return e;throw new Error(`Missing outlet element "${i}" for "${this.identifier}" controller`)}},[`${t}OutletElements`]:{get(){return this.outlets.findAll(i)}},[`has${Y(t)}Outlet`]:{get(){return this.outlets.has(i)}}}}function Yi(i){return Q(i,"targets").reduce((e,n)=>Object.assign(e,Qi(n)),{})}function Qi(i){return{[`${i}Target`]:{get(){let t=this.targets.find(i);if(t)return t;throw new Error(`Missing target element "${i}" for "${this.identifier}" controller`)}},[`${i}Targets`]:{get(){return this.targets.findAll(i)}},[`has${Y(i)}Target`]:{get(){return this.targets.has(i)}}}}function Zi(i){let t=Pi(i,"values"),e={valueDescriptorMap:{get(){return t.reduce((n,r)=>{let s=we(r,this.identifier),o=this.data.getAttributeNameForKey(s.key);return Object.assign(n,{[o]:s})},{})}}};return t.reduce((n,r)=>Object.assign(n,Ii(r)),e)}function Ii(i,t){let e=we(i,t),{key:n,name:r,reader:s,writer:o}=e;return{[r]:{get(){let a=this.data.get(n);return a!==null?s(a):e.defaultValue},set(a){a===void 0?this.data.delete(n):this.data.set(n,o(a))}},[`has${Y(r)}`]:{get(){return this.data.has(n)||e.hasCustomDefaultValue}}}}function we([i,t],e){return rn({controller:e,token:i,typeDefinition:t})}function Xt(i){switch(i){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function X(i){switch(typeof i){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(i))return"array";if(Object.prototype.toString.call(i)==="[object Object]")return"object"}function tn(i){let t=Xt(i.typeObject.type);if(!t)return;let e=X(i.typeObject.default);if(t!==e){let n=i.controller?`${i.controller}.${i.token}`:i.token;throw new Error(`The specified default value for the Stimulus Value "${n}" must match the defined type "${t}". The provided default value of "${i.typeObject.default}" is of type "${e}".`)}return t}function en(i){let t=tn({controller:i.controller,token:i.token,typeObject:i.typeDefinition}),e=X(i.typeDefinition),n=Xt(i.typeDefinition),r=t||e||n;if(r)return r;let s=i.controller?`${i.controller}.${i.typeDefinition}`:i.token;throw new Error(`Unknown value type "${s}" for "${i.token}" value`)}function nn(i){let t=Xt(i);if(t)return sn[t];let e=i.default;return e!==void 0?e:i}function rn(i){let t=`${ye(i.token)}-value`,e=en(i);return{type:e,key:t,name:Jt(t),get defaultValue(){return nn(i.typeDefinition)},get hasCustomDefaultValue(){return X(i.typeDefinition)!==void 0},reader:on[e],writer:me[e]||me.default}}var sn={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},on={array(i){let t=JSON.parse(i);if(!Array.isArray(t))throw new TypeError(`expected value of type "array" but instead got value "${i}" of type "${X(t)}"`);return t},boolean(i){return!(i=="0"||String(i).toLowerCase()=="false")},number(i){return Number(i)},object(i){let t=JSON.parse(i);if(t===null||typeof t!="object"||Array.isArray(t))throw new TypeError(`expected value of type "object" but instead got value "${i}" of type "${X(t)}"`);return t},string(i){return i}},me={default:an,array:ge,object:ge};function ge(i){return JSON.stringify(i)}function an(i){return`${i}`}var O=class{constructor(t){this.context=t}static get shouldLoad(){return!0}static afterLoad(t,e){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(t,{target:e=this.element,detail:n={},prefix:r=this.identifier,bubbles:s=!0,cancelable:o=!0}={}){let a=r?`${r}:${t}`:t,c=new CustomEvent(a,{detail:n,bubbles:s,cancelable:o});return e.dispatchEvent(c),c}};O.blessings=[qi,Yi,Zi,Ji];O.targets=[];O.outlets=[];O.values={};var K=ft.start();K.warnings=!0;K.debug=!0;window.Stimulus=K;var Z=class{constructor(t){this.response=t}get statusCode(){return this.response.status}get redirected(){return this.response.redirected}get ok(){return this.response.ok}get unauthenticated(){return this.statusCode===401}get unprocessableEntity(){return this.statusCode===422}get authenticationURL(){return this.response.headers.get("WWW-Authenticate")}get contentType(){return(this.response.headers.get("Content-Type")||"").replace(/;.*$/,"")}get headers(){return this.response.headers}get html(){return this.contentType.match(/^(application|text)\/(html|xhtml\+xml)$/)?this.text:Promise.reject(new Error(`Expected an HTML response but got "${this.contentType}" instead`))}get json(){return this.contentType.match(/^application\/.*json$/)?this.responseJson||(this.responseJson=this.response.json()):Promise.reject(new Error(`Expected a JSON response but got "${this.contentType}" instead`))}get text(){return this.responseText||(this.responseText=this.response.text())}get isTurboStream(){return this.contentType.match(/^text\/vnd\.turbo-stream\.html/)}async renderTurboStream(){if(this.isTurboStream)window.Turbo?await window.Turbo.renderStreamMessage(await this.text):console.warn("You must set `window.Turbo = Turbo` to automatically process Turbo Stream events with request.js");else return Promise.reject(new Error(`Expected a Turbo Stream response but got "${this.contentType}" instead`))}};var I=class{static register(t){this.interceptor=t}static get(){return this.interceptor}static reset(){this.interceptor=void 0}};function xe(i){let t=document.cookie?document.cookie.split("; "):[],e=`${encodeURIComponent(i)}=`,n=t.find(r=>r.startsWith(e));if(n){let r=n.split("=").slice(1).join("=");if(r)return decodeURIComponent(r)}}function Ee(i){let t={};for(let e in i){let n=i[e];n!==void 0&&(t[e]=n)}return t}function Yt(i){let t=document.head.querySelector(`meta[name="${i}"]`);return t&&t.content}function ke(i){return[...i].reduce((t,[e,n])=>t.concat(typeof n=="string"?[[e,n]]:[]),[])}function Ce(i,t){for(let[e,n]of t)n instanceof window.File||(i.has(e)&&!e.includes("[]")?(i.delete(e),i.set(e,n)):i.append(e,n))}var tt=class{constructor(t,e,n={}){this.method=t,this.options=n,this.originalUrl=e.toString()}async perform(){try{let e=I.get();e&&await e(this)}catch(e){console.error(e)}let t=new Z(await window.fetch(this.url,this.fetchOptions));return t.unauthenticated&&t.authenticationURL?Promise.reject(window.location.href=t.authenticationURL):(t.ok&&t.isTurboStream&&await t.renderTurboStream(),t)}addHeader(t,e){let n=this.additionalHeaders;n[t]=e,this.options.headers=n}sameHostname(){if(!this.originalUrl.startsWith("http:"))return!0;try{return new URL(this.originalUrl).hostname===window.location.hostname}catch{return!0}}get fetchOptions(){return{method:this.method.toUpperCase(),headers:this.headers,body:this.formattedBody,signal:this.signal,credentials:"same-origin",redirect:this.redirect}}get headers(){let t={"X-Requested-With":"XMLHttpRequest","Content-Type":this.contentType,Accept:this.accept};return this.sameHostname()&&(t["X-CSRF-Token"]=this.csrfToken),Ee(Object.assign(t,this.additionalHeaders))}get csrfToken(){return xe(Yt("csrf-param"))||Yt("csrf-token")}get contentType(){return this.options.contentType?this.options.contentType:this.body==null||this.body instanceof window.FormData?void 0:this.body instanceof window.File?this.body.type:"application/json"}get accept(){switch(this.responseKind){case"html":return"text/html, application/xhtml+xml";case"turbo-stream":return"text/vnd.turbo-stream.html, text/html, application/xhtml+xml";case"json":return"application/json, application/vnd.api+json";default:return"*/*"}}get body(){return this.options.body}get query(){let t=(this.originalUrl.split("?")[1]||"").split("#")[0],e=new URLSearchParams(t),n=this.options.query;n instanceof window.FormData?n=ke(n):n instanceof window.URLSearchParams?n=n.entries():n=Object.entries(n||{}),Ce(e,n);let r=e.toString();return r.length>0?`?${r}`:""}get url(){return this.originalUrl.split("?")[0].split("#")[0]+this.query}get responseKind(){return this.options.responseKind||"html"}get signal(){return this.options.signal}get redirect(){return this.options.redirect||"follow"}get additionalHeaders(){return this.options.headers||{}}get formattedBody(){let t=Object.prototype.toString.call(this.body)==="[object String]";return this.headers["Content-Type"]==="application/json"&&!t?JSON.stringify(this.body):this.body}};async function Qt(i,t){return new tt("post",i,t).perform()}function Zt(){let i=document.createElement("div");return i.classList.add("tg-dialog-dots"),i.id="tg-dialog-dots",i.outerHTML}var It=i=>{let t="";return i.tourSteps.length&&i.tourSteps.forEach((e,n)=>{let r=document.createElement("span");r.classList.add("tg-dot"),n===i.activeStep&&r.classList.add("tg-dot-active"),t+=r.outerHTML}),t};var Te=["top","right","bottom","left"],Ae=["start","end"],ee=Te.reduce((i,t)=>i.concat(t,t+"-"+Ae[0],t+"-"+Ae[1]),[]),_=Math.min,R=Math.max,et=Math.round;var F=i=>({x:i,y:i}),cn={left:"right",right:"left",bottom:"top",top:"bottom"},ln={start:"end",end:"start"};function pt(i,t,e){return R(i,_(t,e))}function z(i,t){return typeof i=="function"?i(t):i}function j(i){return i.split("-")[0]}function S(i){return i.split("-")[1]}function ie(i){return i==="x"?"y":"x"}function mt(i){return i==="y"?"height":"width"}function it(i){return["top","bottom"].includes(j(i))?"y":"x"}function gt(i){return ie(it(i))}function Oe(i,t,e){e===void 0&&(e=!1);let n=S(i),r=gt(i),s=mt(r),o=r==="x"?n===(e?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(o=te(o)),[o,te(o)]}function Se(i){return i.replace(/start|end/g,t=>ln[t])}function te(i){return i.replace(/left|right|bottom|top/g,t=>cn[t])}function un(i){return{top:0,right:0,bottom:0,left:0,...i}}function ne(i){return typeof i!="number"?un(i):{top:i,right:i,bottom:i,left:i}}function H(i){return{...i,top:i.y,left:i.x,right:i.x+i.width,bottom:i.y+i.height}}function Be(i,t,e){let{reference:n,floating:r}=i,s=it(t),o=gt(t),a=mt(o),c=j(t),l=s==="y",d=n.x+n.width/2-r.width/2,u=n.y+n.height/2-r.height/2,f=n[a]/2-r[a]/2,h;switch(c){case"top":h={x:d,y:n.y-r.height};break;case"bottom":h={x:d,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:u};break;case"left":h={x:n.x-r.width,y:u};break;default:h={x:n.x,y:n.y}}switch(S(t)){case"start":h[o]-=f*(e&&l?-1:1);break;case"end":h[o]+=f*(e&&l?-1:1);break}return h}var Le=async(i,t,e)=>{let{placement:n="bottom",strategy:r="absolute",middleware:s=[],platform:o}=e,a=s.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t)),l=await o.getElementRects({reference:i,floating:t,strategy:r}),{x:d,y:u}=Be(l,n,c),f=n,h={},p=0;for(let m=0;m<a.length;m++){let{name:b,fn:g}=a[m],{x:y,y:w,data:A,reset:v}=await g({x:d,y:u,initialPlacement:n,placement:f,strategy:r,middlewareData:h,rects:l,platform:o,elements:{reference:i,floating:t}});if(d=y??d,u=w??u,h={...h,[b]:{...h[b],...A}},v&&p<=50){p++,typeof v=="object"&&(v.placement&&(f=v.placement),v.rects&&(l=v.rects===!0?await o.getElementRects({reference:i,floating:t,strategy:r}):v.rects),{x:d,y:u}=Be(l,f,c)),m=-1;continue}}return{x:d,y:u,placement:f,strategy:r,middlewareData:h}};async function re(i,t){var e;t===void 0&&(t={});let{x:n,y:r,platform:s,rects:o,elements:a,strategy:c}=i,{boundary:l="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:f=!1,padding:h=0}=z(t,i),p=ne(h),b=a[f?u==="floating"?"reference":"floating":u],g=H(await s.getClippingRect({element:(e=await(s.isElement==null?void 0:s.isElement(b)))==null||e?b:b.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:l,rootBoundary:d,strategy:c})),y=u==="floating"?{...o.floating,x:n,y:r}:o.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),A=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},v=H(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:w,strategy:c}):y);return{top:(g.top-v.top+p.top)/A.y,bottom:(v.bottom-g.bottom+p.bottom)/A.y,left:(g.left-v.left+p.left)/A.x,right:(v.right-g.right+p.right)/A.x}}var se=i=>({name:"arrow",options:i,async fn(t){let{x:e,y:n,placement:r,rects:s,platform:o,elements:a}=t,{element:c,padding:l=0}=z(i,t)||{};if(c==null)return{};let d=ne(l),u={x:e,y:n},f=gt(r),h=mt(f),p=await o.getDimensions(c),m=f==="y",b=m?"top":"left",g=m?"bottom":"right",y=m?"clientHeight":"clientWidth",w=s.reference[h]+s.reference[f]-u[f]-s.floating[h],A=u[f]-s.reference[f],v=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c)),N=v?v[y]:0;(!N||!await(o.isElement==null?void 0:o.isElement(v)))&&(N=a.floating[y]||s.floating[h]);let at=w/2-A/2,kt=N/2-p[h]/2-1,J=_(d[b],kt),E=_(d[g],kt),T=J,ct=N-p[h]-E,L=N/2-p[h]/2+at,Ct=pt(T,L,ct),he=S(r)!=null&&L!=Ct&&s.reference[h]/2-(L<T?J:E)-p[h]/2<0?L<T?T-L:ct-L:0;return{[f]:u[f]-he,data:{[f]:Ct,centerOffset:L-Ct+he}}}});function dn(i,t,e){return(i?[...e.filter(r=>S(r)===i),...e.filter(r=>S(r)!==i)]:e.filter(r=>j(r)===r)).filter(r=>i?S(r)===i||(t?Se(r)!==r:!1):!0)}var oe=function(i){return i===void 0&&(i={}),{name:"autoPlacement",options:i,async fn(t){var e,n,r;let{rects:s,middlewareData:o,placement:a,platform:c,elements:l}=t,{crossAxis:d=!1,alignment:u,allowedPlacements:f=ee,autoAlignment:h=!0,...p}=z(i,t),m=u!==void 0||f===ee?dn(u||null,h,f):f,b=await re(t,p),g=((e=o.autoPlacement)==null?void 0:e.index)||0,y=m[g];if(y==null)return{};let w=Oe(y,s,await(c.isRTL==null?void 0:c.isRTL(l.floating)));if(a!==y)return{reset:{placement:m[0]}};let A=[b[j(y)],b[w[0]],b[w[1]]],v=[...((n=o.autoPlacement)==null?void 0:n.overflows)||[],{placement:y,overflows:A}],N=m[g+1];if(N)return{data:{index:g+1,overflows:v},reset:{placement:N}};let at=v.map(E=>{let T=S(E.placement);return[E.placement,T&&d?E.overflows.slice(0,2).reduce((ct,L)=>ct+L,0):E.overflows[0],E.overflows]}).sort((E,T)=>E[1]-T[1]),J=((r=at.filter(E=>E[2].slice(0,S(E[0])?2:3).every(T=>T<=0))[0])==null?void 0:r[0])||at[0][0];return J!==a?{data:{index:g+1,overflows:v},reset:{placement:J}}:{}}}};async function hn(i,t){let{placement:e,platform:n,elements:r}=i,s=await(n.isRTL==null?void 0:n.isRTL(r.floating)),o=j(e),a=S(e),c=it(e)==="y",l=["left","top"].includes(o)?-1:1,d=s&&c?-1:1,u=z(t,i),{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...u};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),c?{x:h*d,y:f*l}:{x:f*l,y:h*d}}var ae=function(i){return i===void 0&&(i=0),{name:"offset",options:i,async fn(t){let{x:e,y:n}=t,r=await hn(t,i);return{x:e+r.x,y:n+r.y,data:r}}}},ce=function(i){return i===void 0&&(i={}),{name:"shift",options:i,async fn(t){let{x:e,y:n,placement:r}=t,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:b=>{let{x:g,y}=b;return{x:g,y}}},...c}=z(i,t),l={x:e,y:n},d=await re(t,c),u=it(j(r)),f=ie(u),h=l[f],p=l[u];if(s){let b=f==="y"?"top":"left",g=f==="y"?"bottom":"right",y=h+d[b],w=h-d[g];h=pt(y,h,w)}if(o){let b=u==="y"?"top":"left",g=u==="y"?"bottom":"right",y=p+d[b],w=p-d[g];p=pt(y,p,w)}let m=a.fn({...t,[f]:h,[u]:p});return{...m,data:{x:m.x-e,y:m.y-n}}}}};function P(i){return Fe(i)?(i.nodeName||"").toLowerCase():"#document"}function x(i){var t;return(i==null||(t=i.ownerDocument)==null?void 0:t.defaultView)||window}function D(i){var t;return(t=(Fe(i)?i.ownerDocument:i.document)||window.document)==null?void 0:t.documentElement}function Fe(i){return i instanceof Node||i instanceof x(i).Node}function B(i){return i instanceof Element||i instanceof x(i).Element}function C(i){return i instanceof HTMLElement||i instanceof x(i).HTMLElement}function Me(i){return typeof ShadowRoot>"u"?!1:i instanceof ShadowRoot||i instanceof x(i).ShadowRoot}function W(i){let{overflow:t,overflowX:e,overflowY:n,display:r}=k(i);return/auto|scroll|overlay|hidden|clip/.test(t+n+e)&&!["inline","contents"].includes(r)}function Pe(i){return["table","td","th"].includes(P(i))}function yt(i){let t=bt(),e=k(i);return e.transform!=="none"||e.perspective!=="none"||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(e.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(e.contain||"").includes(n))}function De(i){let t=G(i);for(;C(t)&&!nt(t);){if(yt(t))return t;t=G(t)}return null}function bt(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function nt(i){return["html","body","#document"].includes(P(i))}function k(i){return x(i).getComputedStyle(i)}function rt(i){return B(i)?{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}:{scrollLeft:i.pageXOffset,scrollTop:i.pageYOffset}}function G(i){if(P(i)==="html")return i;let t=i.assignedSlot||i.parentNode||Me(i)&&i.host||D(i);return Me(t)?t.host:t}function Ne(i){let t=G(i);return nt(t)?i.ownerDocument?i.ownerDocument.body:i.body:C(t)&&W(t)?t:Ne(t)}function le(i,t){var e;t===void 0&&(t=[]);let n=Ne(i),r=n===((e=i.ownerDocument)==null?void 0:e.body),s=x(n);return r?t.concat(s,s.visualViewport||[],W(n)?n:[]):t.concat(n,le(n))}function Ve(i){let t=k(i),e=parseFloat(t.width)||0,n=parseFloat(t.height)||0,r=C(i),s=r?i.offsetWidth:e,o=r?i.offsetHeight:n,a=et(e)!==s||et(n)!==o;return a&&(e=s,n=o),{width:e,height:n,$:a}}function _e(i){return B(i)?i:i.contextElement}function q(i){let t=_e(i);if(!C(t))return F(1);let e=t.getBoundingClientRect(),{width:n,height:r,$:s}=Ve(t),o=(s?et(e.width):e.width)/n,a=(s?et(e.height):e.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}var fn=F(0);function je(i){let t=x(i);return!bt()||!t.visualViewport?fn:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function pn(i,t,e){return t===void 0&&(t=!1),!e||t&&e!==x(i)?!1:t}function st(i,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=!1);let r=i.getBoundingClientRect(),s=_e(i),o=F(1);t&&(n?B(n)&&(o=q(n)):o=q(i));let a=pn(s,e,n)?je(s):F(0),c=(r.left+a.x)/o.x,l=(r.top+a.y)/o.y,d=r.width/o.x,u=r.height/o.y;if(s){let f=x(s),h=n&&B(n)?x(n):n,p=f.frameElement;for(;p&&n&&h!==f;){let m=q(p),b=p.getBoundingClientRect(),g=k(p),y=b.left+(p.clientLeft+parseFloat(g.paddingLeft))*m.x,w=b.top+(p.clientTop+parseFloat(g.paddingTop))*m.y;c*=m.x,l*=m.y,d*=m.x,u*=m.y,c+=y,l+=w,p=x(p).frameElement}}return H({width:d,height:u,x:c,y:l})}function mn(i){let{rect:t,offsetParent:e,strategy:n}=i,r=C(e),s=D(e);if(e===s)return t;let o={scrollLeft:0,scrollTop:0},a=F(1),c=F(0);if((r||!r&&n!=="fixed")&&((P(e)!=="body"||W(s))&&(o=rt(e)),C(e))){let l=st(e);a=q(e),c.x=l.x+e.clientLeft,c.y=l.y+e.clientTop}return{width:t.width*a.x,height:t.height*a.y,x:t.x*a.x-o.scrollLeft*a.x+c.x,y:t.y*a.y-o.scrollTop*a.y+c.y}}function gn(i){return Array.from(i.getClientRects())}function He(i){return st(D(i)).left+rt(i).scrollLeft}function yn(i){let t=D(i),e=rt(i),n=i.ownerDocument.body,r=R(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=R(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight),o=-e.scrollLeft+He(i),a=-e.scrollTop;return k(n).direction==="rtl"&&(o+=R(t.clientWidth,n.clientWidth)-r),{width:r,height:s,x:o,y:a}}function bn(i,t){let e=x(i),n=D(i),r=e.visualViewport,s=n.clientWidth,o=n.clientHeight,a=0,c=0;if(r){s=r.width,o=r.height;let l=bt();(!l||l&&t==="fixed")&&(a=r.offsetLeft,c=r.offsetTop)}return{width:s,height:o,x:a,y:c}}function vn(i,t){let e=st(i,!0,t==="fixed"),n=e.top+i.clientTop,r=e.left+i.clientLeft,s=C(i)?q(i):F(1),o=i.clientWidth*s.x,a=i.clientHeight*s.y,c=r*s.x,l=n*s.y;return{width:o,height:a,x:c,y:l}}function Re(i,t,e){let n;if(t==="viewport")n=bn(i,e);else if(t==="document")n=yn(D(i));else if(B(t))n=vn(t,e);else{let r=je(i);n={...t,x:t.x-r.x,y:t.y-r.y}}return H(n)}function Ge(i,t){let e=G(i);return e===t||!B(e)||nt(e)?!1:k(e).position==="fixed"||Ge(e,t)}function wn(i,t){let e=t.get(i);if(e)return e;let n=le(i).filter(a=>B(a)&&P(a)!=="body"),r=null,s=k(i).position==="fixed",o=s?G(i):i;for(;B(o)&&!nt(o);){let a=k(o),c=yt(o);!c&&a.position==="fixed"&&(r=null),(s?!c&&!r:!c&&a.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||W(o)&&!c&&Ge(i,o))?n=n.filter(d=>d!==o):r=a,o=G(o)}return t.set(i,n),n}function xn(i){let{element:t,boundary:e,rootBoundary:n,strategy:r}=i,o=[...e==="clippingAncestors"?wn(t,this._c):[].concat(e),n],a=o[0],c=o.reduce((l,d)=>{let u=Re(t,d,r);return l.top=R(u.top,l.top),l.right=_(u.right,l.right),l.bottom=_(u.bottom,l.bottom),l.left=R(u.left,l.left),l},Re(t,a,r));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function En(i){return Ve(i)}function kn(i,t,e){let n=C(t),r=D(t),s=e==="fixed",o=st(i,!0,s,t),a={scrollLeft:0,scrollTop:0},c=F(0);if(n||!n&&!s)if((P(t)!=="body"||W(r))&&(a=rt(t)),n){let l=st(t,!0,s,t);c.x=l.x+t.clientLeft,c.y=l.y+t.clientTop}else r&&(c.x=He(r));return{x:o.left+a.scrollLeft-c.x,y:o.top+a.scrollTop-c.y,width:o.width,height:o.height}}function $e(i,t){return!C(i)||k(i).position==="fixed"?null:t?t(i):i.offsetParent}function Ke(i,t){let e=x(i);if(!C(i))return e;let n=$e(i,t);for(;n&&Pe(n)&&k(n).position==="static";)n=$e(n,t);return n&&(P(n)==="html"||P(n)==="body"&&k(n).position==="static"&&!yt(n))?e:n||De(i)||e}var Cn=async function(i){let{reference:t,floating:e,strategy:n}=i,r=this.getOffsetParent||Ke,s=this.getDimensions;return{reference:kn(t,await r(e),n),floating:{x:0,y:0,...await s(e)}}};function An(i){return k(i).direction==="rtl"}var Tn={convertOffsetParentRelativeRectToViewportRelativeRect:mn,getDocumentElement:D,getClippingRect:xn,getOffsetParent:Ke,getElementRects:Cn,getClientRects:gn,getDimensions:En,getScale:q,isElement:B,isRTL:An};var ze=(i,t,e)=>{let n=new Map,r={platform:Tn,...e},s={...r.platform,_c:n};return Le(i,t,{...r,platform:s})};async function We(){return this.dialog=document.createElement("div"),this.dialog.classList.add("tg-dialog"),await ot(this).then(i=>{this.dialog.innerHTML=i}),document.body.append(this.dialog),!0}async function ot(i){i.options.dialogClass&&i.dialog.classList.add(i.options.dialogClass),i.options.dialogZ&&(i.dialog.style.zIndex=String(i.options.dialogZ)),i.dialog.style.width=i.options.dialogWidth?i.options.dialogWidth+"px":"auto",i.options.dialogMaxWidth&&(i.dialog.style.maxWidth=i.options.dialogMaxWidth+"px");let t="";if(t+="<div class='tg-dialog-header'>",t+='<div class="tg-dialog-title" id="tg-dialog-title"><!-- JS rendered --></div>',i.options.closeButton&&(t+='<div class="tg-dialog-close-btn" id="tg-dialog-close-btn">',t+=' <svg width="12px" height="12px" id="Layer_1" version="1.1" viewBox="0 0 512 512" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path d="M443.6,387.1L312.4,255.4l131.5-130c5.4-5.4,5.4-14.2,0-19.6l-37.4-37.6c-2.6-2.6-6.1-4-9.8-4c-3.7,0-7.2,1.5-9.8,4  L256,197.8L124.9,68.3c-2.6-2.6-6.1-4-9.8-4c-3.7,0-7.2,1.5-9.8,4L68,105.9c-5.4,5.4-5.4,14.2,0,19.6l131.5,130L68.4,387.1  c-2.6,2.6-4.1,6.1-4.1,9.8c0,3.7,1.4,7.2,4.1,9.8l37.4,37.6c2.7,2.7,6.2,4.1,9.8,4.1c3.5,0,7.1-1.3,9.8-4.1L256,313.1l130.7,131.1  c2.7,2.7,6.2,4.1,9.8,4.1c3.5,0,7.1-1.3,9.8-4.1l37.4-37.6c2.6-2.6,4.1-6.1,4.1-9.8C447.7,393.2,446.2,389.7,443.6,387.1z"/></svg>',t+="</div>"),t+="</div>",i.options.progressBar&&(t+='<div class="tg-dialog-progress-bar"><span class="tg-bar" id="tg-dialog-progbar"></span></div>'),t+='<div class="tg-dialog-body" id="tg-dialog-body"><!-- JS rendered --></div>',i.options.showStepDots&&i.options.stepDotsPlacement==="body"){let r=Zt();r&&(t+=r)}t+='<div class="tg-dialog-footer">';let e="tg-dialog-btn",n="false";if(i.activeStep===0&&(n="true",e+=" disabled"),i.options.showButtons&&!i.options.hidePrev&&(t+='<button type="button" class="'+e+'" id="tg-dialog-prev-btn" disabled="'+n+`">${i.options.prevLabel}</button>`),t+='<div class="tg-dialog-footer-sup">',i.options.showStepDots&&i.options.stepDotsPlacement==="footer"){let r=Zt();r&&(t+=r)}return i.options.showStepProgress&&(t+='<span class="tg-step-progress" id="tg-step-progress"><!-- JS rendered --></span>'),t+="</div>",i.options.showButtons&&!i.options.hideNext&&(t+=`<button type="button" class="tg-dialog-btn" id="tg-dialog-next-btn">${i.options.nextLabel}</button>`),t+="</div>",t+='<div id="tg-arrow" class="tg-arrow"></div><!-- end tour arrow -->',t}function $(i){return new Promise((t,e)=>{let n=i.tourSteps[i.activeStep];n||e("No active step data");let r=document.getElementById("tg-dialog-title");r&&(r.innerHTML=n.title?n.title:"");let s=document.getElementById("tg-dialog-body");s&&n&&(typeof n.content=="string"?s.innerHTML=n.content?n.content:"":(s.innerHTML="",s.append(n.content)));let o=document.getElementById("tg-dialog-dots");o&&i.options.showStepDots&&It(i)&&(o.innerHTML=It(i));let a=document.getElementById("tg-dialog-prev-btn");a&&(i.activeStep===0?(a.classList.add("disabled"),a.setAttribute("disabled","true")):(a.classList.remove("disabled"),a.removeAttribute("disabled")));let c=document.getElementById("tg-dialog-next-btn");c&&(c.innerHTML=i.activeStep+1>=i.tourSteps.length?i.options.finishLabel:i.options.nextLabel);let l=document.getElementById("tg-step-progress");l&&(l.innerHTML=i.activeStep+1+"/"+i.tourSteps.length);let d=document.getElementById("tg-dialog-progbar");d&&(i.options.progressBar&&(d.style.backgroundColor=i.options.progressBar),d.style.width=(i.activeStep+1)/i.tourSteps.length*100+"%"),t(!0)})}function vt(i){return new Promise(async t=>{let e=document.querySelector("#tg-arrow"),n=i.tourSteps[i.activeStep].target;if(n===document.body)return Object.assign(i.dialog.style,{top:`${window.innerHeight/2.25-i.dialog.clientHeight/2}px`,left:`${window.innerWidth/2-i.dialog.clientWidth/2}px`,position:"fixed"}),i.dialog.classList.add("tg-dialog-fixed"),e&&(e.style.display="none"),t(!0);i.dialog.style.position="absolute",i.dialog.classList.remove("tg-dialog-fixed"),e&&(e.style.display="inline-block"),ze(n,i.dialog,{placement:i.options.dialogPlacement,middleware:[oe({autoAlignment:!0,padding:5}),ce({padding:15}),se({element:e}),ae(20)]}).then(({x:r,y:s,placement:o,middlewareData:a})=>{if(Object.assign(i.dialog.style,{left:`${r}px`,top:`${s}px`}),a.arrow){let c=a.arrow.x,l=a.arrow.y,d={top:"bottom",right:"left",bottom:"top",left:"right"}[o.split("-")[0]];e&&Object.assign(e.style,{left:c!=null?`${c}px`:"",top:l!=null?`${l}px`:"",[d]:"-4px"})}return t(!0)})})}function qe(){this.backdrop=document.createElement("div"),this.computeBackdropAttributes(),document.body.append(this.backdrop)}function Ue(){this.options&&(this.backdrop.className="tg-backdrop",this.backdrop.style.boxShadow=this.options.backdropColor+" 0 0 1px 2px, "+this.options.backdropColor+" 0 0 0 1000vh",this.options.backdropClass&&this.backdrop.classList.add(this.options.backdropClass),this.options.dialogAnimate&&this.backdrop.classList.add("tg-backdrop-animate"))}function ue(i){return new Promise(async(t,e)=>{if(typeof i.options.targetPadding>"u")return e("Options failed to initialize");if(!i.backdrop)return e("No backdrop element initialized");let n=i.tourSteps[i.activeStep],r=n.target,s=r.getBoundingClientRect(),o=s.width+i.options.targetPadding>document.documentElement.clientWidth;r===document.body?(s.width=0,s.height=0,i.backdrop.style.position="fixed",i.backdrop.style.top=window.innerHeight/2.5+"px",i.backdrop.style.left=window.innerWidth/2+"px"):n.fixed?(i.backdrop.style.position="fixed",i.backdrop.style.top=s.top-i.options.targetPadding/2+"px",i.backdrop.style.left=(o?s.x:s.x-i.options.targetPadding/2)+"px"):(i.backdrop.style.position="absolute",i.backdrop.style.top=window.scrollY+s.top-i.options.targetPadding/2+"px",i.backdrop.style.left=(o?s.x:s.x-i.options.targetPadding/2)+"px"),i.backdrop.style.width=(o?s.width:s.width+i.options.targetPadding)+"px",i.backdrop.style.height=(s.height?s.height+i.options.targetPadding:s.height)+"px",t(!0)})}function On(){return new Promise(async i=>{this.backdrop.style.display="block",await ue(this),this.dialog.style.display="block",this.options.dialogAnimate&&this.isVisible&&this.dialog.classList.add("animate-position"),await vt(this),this.options.dialogAnimate&&setTimeout(()=>{this.dialog.classList.remove("animate-position")},300),this.isVisible=!0,window.onresize||(window.onresize=()=>{ue(this),vt(this)}),window.onscroll||(window.onscroll=()=>{vt(this)}),await setTimeout(()=>i(!0),300)})}var Je=On;function Xe(i){if(typeof i=="function")this._globalFinishCallback=i;else throw new Error("Provided callback for onFinish was not a function")}function Ye(i){if(typeof i=="function")this._globalBeforeExitCallback=i;else throw new Error("Provided callback for onBeforeExit was not a function")}function Qe(i){if(typeof i=="function")this._globalAfterExitCallback=i;else throw new Error("Provided callback for onAfterExit was not a function")}function Ze(i){if(typeof i=="function")this._globalBeforeChangeCallback=i;else throw new Error("Provided callback for onBeforeStepChange was not a function")}function Ie(i){if(typeof i=="function")this._globalAfterChangeCallback=i;else throw new Error("Provided callback for onAfterStepChange was not a function")}var ti=async function(i){if(i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation(),!(i.target instanceof Element))return;let t=this.backdrop.getBoundingClientRect();if(i.clientX>=t.x&&i.clientX<=t.x+t.width&&i.clientY>=t.y&&i.clientY<=t.y+t.height)return;let e=this.dialog.getBoundingClientRect();i.clientX>=e.x&&i.clientX<=e.x+e.width&&i.clientY>=e.y&&i.clientY<=e.y+e.height||this.dialog.contains(i.target)||await this.exit()},ei=async function(i){if(i.key==="Escape"&&this.options.exitOnEscape){i.preventDefault(),await this.exit();return}if(i.key==="ArrowRight"&&this.options.keyboardControls){i.preventDefault(),this.visitStep("next").catch(t=>{this.options.debug&&console.warn(t)});return}if(i.key==="ArrowLeft"&&this.options.keyboardControls){i.preventDefault(),this.visitStep("prev").catch(t=>{this.options.debug&&console.warn(t)});return}};function ii(){let i=()=>{let s=document.getElementById("tg-dialog-next-btn");!s||this._trackedEvents.nextBtnClickEvent.initialized||(s.addEventListener("click",this._trackedEvents.nextBtnClickEvent.fn),this._trackedEvents.nextBtnClickEvent.initialized=!0)},t=()=>{let s=document.getElementById("tg-dialog-prev-btn");!s||this._trackedEvents.prevBtnClickEvent.initialized||(s.addEventListener("click",this._trackedEvents.prevBtnClickEvent.fn),this._trackedEvents.prevBtnClickEvent.initialized=!0)},e=()=>{let s=document.getElementById("tg-dialog-close-btn");!s||this._trackedEvents.closeBtnClickEvent.initialized||(s.addEventListener("click",this._trackedEvents.closeBtnClickEvent.fn,!1),this._trackedEvents.closeBtnClickEvent.initialized=!0)},n=()=>{this._trackedEvents.outsideClickEvent.initialized||(document.body.addEventListener("click",this._trackedEvents.outsideClickEvent.fn,!1),this._trackedEvents.outsideClickEvent.initialized=!0)},r=()=>{this._trackedEvents.keyPressEvent.initialized||(window.addEventListener("keydown",this._trackedEvents.keyPressEvent.fn,!1),this._trackedEvents.keyPressEvent.initialized=!0)};return new Promise(s=>(this.options.showButtons&&i(),this.options.showButtons&&t(),this.options.closeButton&&e(),this.options.exitOnClickOutside&&n(),(this.options.keyboardControls||this.options.exitOnEscape)&&r(),s(!0)))}function ni(){let i=()=>{let s=document.getElementById("tg-dialog-next-btn");s&&(s.removeEventListener("click",this._trackedEvents.nextBtnClickEvent.fn),this._trackedEvents.nextBtnClickEvent.initialized=!1)},t=()=>{let s=document.getElementById("tg-dialog-prev-btn");s&&(s.removeEventListener("click",this._trackedEvents.prevBtnClickEvent.fn),this._trackedEvents.prevBtnClickEvent.initialized=!1)},e=()=>{let s=document.getElementById("tg-dialog-close-btn");s&&(s.removeEventListener("click",this._trackedEvents.closeBtnClickEvent.fn,!1),this._trackedEvents.closeBtnClickEvent.initialized=!1)},n=()=>{document.body.removeEventListener("click",this._trackedEvents.outsideClickEvent.fn,!1),this._trackedEvents.outsideClickEvent.initialized=!1},r=()=>{window.removeEventListener("keydown",this._trackedEvents.keyPressEvent.fn,!1),this._trackedEvents.keyPressEvent.initialized=!1};return new Promise(s=>(this.options.showButtons&&i(),this.options.showButtons&&t(),this.options.closeButton&&e(),this.options.exitOnClickOutside&&n(),(this.options.keyboardControls||this.options.exitOnEscape)&&r(),s(!0)))}var Sn=(i,t)=>{t.scrollIntoView({behavior:i.options.autoScrollSmooth?"smooth":"auto",block:"end",inline:"nearest"})},ri=Sn;async function Bn(i){return new Promise(async(t,e)=>{if(typeof i=="string"&&(i==="next"?i=this.activeStep+1:i=this.activeStep-1),i>=this.tourSteps.length){await this.finishTour(!0,this.group);return}return await Ln(this,i).catch(n=>e(n)),t(!0)})}async function si(){return new Promise(async(i,t)=>{let e=this.activeStep+1;try{await this.visitStep(e)}catch(n){return t(n)}return i(!0)})}async function oi(){return new Promise(async(i,t)=>{let e=this.activeStep-1;try{await this.visitStep(e)}catch(n){return t(n)}return i(!0)})}function Ln(i,t){return new Promise(async(e,n)=>{if(t>=i.tourSteps.length)return n("End of tour steps");if(t<0)return n("Start of tour steps");let r=i.activeStep,s=i.tourSteps[r],o=i.tourSteps[t];if(!o||!s)return n("Step not found by index");if(i._globalBeforeChangeCallback&&t!==r)try{await i._globalBeforeChangeCallback()}catch(a){return n(a)}if(s.beforeLeave)try{await s.beforeLeave(s,o)}catch(a){return n(a)}if(o.beforeEnter)try{await o.beforeEnter(s,o)}catch(a){return n(a)}return typeof o.target=="string"&&(i.tourSteps[t].target=document.querySelector(o.target)),(!o.target||!i.tourSteps[t].target)&&(i.tourSteps[t].target=document.body),i.activeStep=Number(t),await $(i).catch(a=>{i.options.debug&&console.warn(a),n(a)}),i.options.autoScroll&&o.target!==document.body&&await ri(i,o.target),await i.updatePositions(),s.afterLeave&&await s.afterLeave(s,o),o.afterEnter&&await o.afterEnter(s,o),i._globalAfterChangeCallback&&t!==r&&await i._globalAfterChangeCallback(),e(!0)})}var ai=Bn;async function Mn(i){return new Promise(async(t,e)=>{let n=[];i.options.steps&&i.options.steps.length&&(n=i.options.steps.map(s=>(typeof s.target=="string"&&(s.target=document.querySelector(s.target)),s.target||(s.target=document.body),s)));let r=document.querySelectorAll("[data-tg-tour]");return r&&r.forEach(s=>{let o=s.getAttribute("data-tg-title"),a=s.getAttribute("data-tg-tour"),c=s.getAttribute("data-tg-group"),l=s.getAttribute("data-tg-order"),d=s.getAttribute("data-tg-fixed"),u=s.getAttribute("data-tg-margin");i.options.targetPadding&&i.options.autoScrollOffset?s.style.scrollMargin=(u?u+i.options.targetPadding:i.options.autoScrollOffset+i.options.targetPadding)+"px 0":s.style.scrollMargin=(u||"30")+"px 0",n.push({title:o||void 0,order:l?Number(l):999,target:s,content:a||void 0,fixed:d!==null&&d!=="false",group:c||void 0})}),i.group&&(n=n.filter(s=>s.group===i.group)),n.sort(function(s,o){let a=new Date(s.order),c=new Date(o.order);return a<c?-1:1}),i.tourSteps=n,i.tourSteps.length?t(!0):e("No tour steps detected"+(i.group?" in group: "+i.group:""))})}var U=Mn;function Fn(i){return new Promise(t=>{if(document.querySelector(i))return t(document.querySelector(i));let e=new MutationObserver(()=>{document.querySelector(i)&&(t(document.querySelector(i)),e.disconnect())});e.observe(document.body,{childList:!0,subtree:!0})})}var V=Fn;async function Pn(i){this.options.steps&&(this.options.steps.push(...i),await U(this),this.isVisible&&await $(this).catch(t=>{this.options.debug&&console.warn(t)}),this.isVisible&&this.updatePositions().catch(t=>{this.options.debug&&console.warn(t)}),this.isVisible&&await V(".tg-dialog").then(async()=>(await this.destroyListeners(),await this.initListeners(),!0)))}var ci=Pn;async function Dn(i){return new Promise(async(t,e)=>{if(this.isVisible)return this.options.debug&&console.warn("Tour already active"),e("Tour already active");i&&(this.group=i),this.options.debug&&console.info("Start tour");let n=this;try{await U(n)}catch(r){return this.options.debug&&console.warn(r),e(r)}return await n.visitStep(this.activeStep).catch(r=>(this.options.debug&&console.warn(r),e(r))),await V(".tg-dialog").then(async()=>{await this.initListeners(),this.options.dialogAnimate&&this.dialog.classList.add("animate-position")}),t(!0)})}var li=Dn;async function Nn(i){if(i)return Object.assign(this.options,i),this.computeBackdropAttributes(),await ot(this).then(t=>{t&&(this.dialog.innerHTML=t)}).catch(t=>{this.options.debug&&console.warn(t)}),await $(this).catch(t=>{this.options.debug&&console.warn(t)}),this.isVisible&&await V(".tg-dialog").then(async()=>(await this.destroyListeners(),await this.initListeners(),!0)),this}var ui=Nn;async function Rn(){if(this._globalBeforeExitCallback)try{await this._globalBeforeExitCallback()}catch{return}this.dialog.style.display="none",this.backdrop.style.display="none",this.isVisible=!1,this.options.rememberStep||(this.activeStep=0),this.options.debug&&console.info("Tour exited"),await this.destroyListeners(),setTimeout(()=>{this._globalAfterExitCallback&&this._globalAfterExitCallback()},0)}var di=Rn;async function $n(){return new Promise(async(i,t)=>(await U(this).catch(e=>t(e)),this.computeBackdropAttributes(),await this.refreshDialog().catch(e=>t(e)),i(!0)))}async function hi(){return new Promise(async(i,t)=>(await ot(this).then(e=>{e&&(this.dialog.innerHTML=e)}).catch(e=>{this.options.debug&&console.warn(e)}),await $(this).catch(e=>{this.options.debug&&console.warn(e),t(e)}),await this.updatePositions(),this.isVisible&&await V(".tg-dialog").then(async()=>(await this.destroyListeners(),await this.initListeners(),!0)),i(!0)))}var fi=$n;async function Vn(i=!0,t="tour"){if(this._globalFinishCallback)try{await this._globalFinishCallback()}catch{return!1}if(this.options.completeOnFinish){if(!localStorage.tg_tours_complete){localStorage.tg_tours_complete=[t],i&&await this.exit(),this.activeStep=0;return}let e=localStorage.tg_tours_complete.split(",");e.push(t),localStorage.tg_tours_complete=e}return i&&await this.exit(),this.activeStep=0,!0}function pi(i="tour"){return localStorage.tg_tours_complete.split(",").includes(i)}function mi(i="tour"){if(i==="all"){localStorage.tg_tours_complete=null;return}let t=localStorage.tg_tours_complete.split(",");localStorage.tg_tours_complete=t.filter(e=>e!==i)}var gi=Vn;var _n={nextLabel:"Next",prevLabel:"Back",finishLabel:"Finish",hidePrev:!1,hideNext:!1,dialogClass:"",dialogZ:999,dialogWidth:0,dialogMaxWidth:340,dialogAnimate:!0,dialogPlacement:void 0,backdropClass:"",backdropColor:"rgba(20,20,21,0.84)",backdropAnimate:!0,targetPadding:30,completeOnFinish:!0,showStepDots:!0,stepDotsPlacement:"footer",showButtons:!0,showStepProgress:!0,progressBar:"",keyboardControls:!0,exitOnEscape:!0,exitOnClickOutside:!0,autoScroll:!0,autoScrollSmooth:!0,autoScrollOffset:20,closeButton:!0,rememberStep:!1,debug:!0,steps:[]},de=_n;var wt=class{backdrop;dialog;group="";isVisible=!1;activeStep=0;tourSteps=[];options=de;isFinished=pi;constructor(t){this.dialog=document.createElement("div"),this.backdrop=document.createElement("div"),this.options=de,t&&Object.assign(this.options,t),this.createTourGuideDialog().catch(e=>{this.options.debug&&console.warn(e)}),this.createTourGuideBackdrop()}createTourGuideBackdrop=qe;computeBackdropAttributes=Ue;createTourGuideDialog=We;start=li;visitStep=ai;addSteps=ci;nextStep=si;prevStep=oi;exit=di;refresh=fi;refreshDialog=hi;finishTour=gi;updatePositions=Je;deleteFinishedTour=mi;setOptions=ui;initListeners=ii;destroyListeners=ni;_trackedEvents={nextBtnClickEvent:{initialized:!1,fn:this.nextStep.bind(this)},prevBtnClickEvent:{initialized:!1,fn:this.prevStep.bind(this)},closeBtnClickEvent:{initialized:!1,fn:this.exit.bind(this)},keyPressEvent:{initialized:!1,fn:ei.bind(this)},outsideClickEvent:{initialized:!1,fn:ti.bind(this)}};_globalFinishCallback;_globalBeforeExitCallback;_globalAfterExitCallback;_globalBeforeChangeCallback;_globalAfterChangeCallback;onFinish=Xe;onBeforeExit=Ye;onAfterExit=Qe;onBeforeStepChange=Ze;onAfterStepChange=Ie};var xt=class extends O{static targets=["configuration"];static values={tourId:Number,selector:String,userSgid:String,eventPath:String};connect(){this.passesContentSelector()||this.element.remove()}disconnect(){}setupTour(){let i={steps:[]},t=JSON.parse(this.tourConfig),e={...i,...t};this.tour=new wt(e),this.tour.onAfterStepChange(this.onStep.bind(this)),this.tour.onBeforeExit(this.onQuit.bind(this)),this.tour.onFinish(this.onComplete.bind(this))}startTour(){this.tour?this.tour.visitStep(0):this.setupTour(),this.tour.start(),this.sendBeacon("start")}onStep(){let i=`${this.tour.activeStep}: ${this.tour.tourSteps[this.tour.activeStep].title}`;this.sendBeacon("step",i)}onQuit(){this.tour.activeStep!==this.tour.tourSteps.length-1&&this.sendBeacon("quit")}onComplete(){this.sendBeacon("complete")}passesContentSelector(){return!this.hasSelectorValue||document.querySelector(this.selectorValue)!=null}async sendBeacon(i,t){if(!this.hasUserSgidValue){console.log("no user");return}console.log("sending tracking beacon",i,t);let e=JSON.stringify({event:{tour_id:this.tourIdValue,action:i,identifier:t,user_sgid:this.userSgidValue}});if(!(await Qt(this.eventPathValue,{body:e})).ok){console.error("failed");debugger}}get tourConfig(){return this.hasConfigurationTarget?this.configurationTarget.innerHTML:this.element.innerHTML}};var Et=class extends O{static outlets=["tour"];connect(){this.tourOutlets[0]?.startTour()}};K.register("tour",xt);K.register("tours",Et);})();
//# sourceMappingURL=tour_maven.js.map
